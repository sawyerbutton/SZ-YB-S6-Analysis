# SZ-YB-S6 Dota2 对手分析工具

使用 OpenDota API 获取玩家数据，生成 **BP专用分析报告**，辅助赛前策略制定。

## 项目目标

为联赛BP（Ban/Pick）阶段提供数据支持：
1. 了解对手各位置选手的**英雄池深度**
2. 识别对手的**招牌英雄**（必Ban候选）
3. 发现**英雄池较浅**的选手，便于针对性Ban人
4. 追踪选手**近期状态**，判断威胁程度

## 快速开始

### 1. 安装依赖

```bash
pip install requests
```

### 2. 运行分析

```bash
python dota2_analyzer.py
```

### 3. 查看报告

运行完成后在 `output/` 目录生成以下文件：

| 文件 | 用途 |
|------|------|
| `bp_report_*.html` | **BP专用报告（推荐）** - 浏览器打开，可视化展示 |
| `bp_report_*.txt` | BP报告文本版 - 可直接复制分享 |
| `dota2_report_*.html` | 完整数据报告 |
| `dota2_summary_*.txt` | 微信/飞书友好的简洁摘要 |
| `dota2_analysis_*.json` | 原始JSON数据 |

## 分析思路

### 核心概念

#### 1. 招牌英雄 vs 常用英雄

**问题**：单纯按"使用场次"排序不能反映真正擅长的英雄。
- 例：VK的Legion Commander打了15场但胜率只有33%，不应该Ban

**解决方案**：定义"招牌英雄"需同时满足：
- 场次 ≥ 5（有足够样本）
- 胜率 ≥ 55%（真正擅长）

#### 2. 威胁级别

| 级别 | 条件 | 标记 |
|------|------|------|
| 高威胁 | 胜率 ≥ 60% | 🔴 |
| 中威胁 | 胜率 ≥ 55% | 🟡 |
| 熟练 | 胜率 45-55% | 无标记 |

#### 3. Ban优先级计算

```
优先级分数 = 胜率 + 场次加成 + 高胜率加成

场次加成：
  - ≥15场: +10分
  - ≥10场: +5分

高胜率加成：
  - ≥70%: +15分
  - ≥60%: +8分
```

#### 4. 英雄池深度评估

- **英雄池深**：招牌英雄 ≥ 3个，难以通过Ban针对
- **英雄池浅**：招牌英雄 ≤ 2个，Ban掉后可能影响发挥

#### 5. 状态趋势分析

对比最近20场与前80场的数据：
- 🔥 **状态上升**：近期胜率提升 >5% 且 KDA提升 >0.3
- 📉 **状态下滑**：近期胜率下降 >5% 且 KDA下降 >0.3
- ➡️ **状态稳定**：变化不大

### BP建议使用方法

1. **赛前准备**：打开对手队伍的BP报告
2. **优先Ban**：查看"Ban优先级排序"，优先Ban高威胁(🔴)英雄
3. **针对弱点**：关注"英雄池较浅"的选手，2-3个Ban可能卡死
4. **共用英雄**：如果队伍多人共用某英雄，一个Ban影响多人

## 数据维度说明

### 位置分析
基于英雄类型推断选手主要位置：
- Carry英雄多 → 1号位
- Mid英雄多 → 2号位
- Offlane英雄多 → 3号位
- Support英雄多 → 4/5号位

### 对局时长分析
分析选手在不同时长对局的表现：
- 早期：< 30分钟
- 中期：30-45分钟
- 后期：> 45分钟

## 配置说明

### 修改玩家列表

编辑 `dota2_analyzer.py` 中的 `TEAMS` 字典：

```python
TEAMS = {
    1: {
        "name": "队伍1",
        "color": "#FFF2CC",  # 队伍颜色
        "players": {
            "玩家昵称": account_id,  # 32位Account ID
        }
    },
    # ...
}
```

### Steam ID 转换

如果你只有64位Steam ID，需要转换为32位Account ID：

```python
account_id_32 = steam_id_64 - 76561197960265728
```

例如：
- Steam64: 76561198083800272
- Account ID: 123534544

### 调整分析参数

```python
# BP分析参数
BP_MIN_GAMES = 5       # 最少场次才算"擅长"
BP_HIGH_WINRATE = 55   # 高胜率阈值(%)
BP_THREAT_WINRATE = 60 # 威胁级胜率阈值(%)

# API参数
REQUEST_DELAY = 1.5    # 请求间隔（秒）
MATCHES_LIMIT = 100    # 获取最近的比赛数量
```

## 注意事项

1. **隐私设置**: 玩家必须在Dota 2设置中开启「公开比赛数据」
2. **API限制**: 建议保持1.5秒以上的请求间隔，避免限流
3. **数据时效**: OpenDota数据可能有几分钟到几小时的延迟

## 缺失的玩家ID

以下玩家Steam ID仍需补充：
- 队伍1: JY.LIU
- 队伍3: will, walker
- 队伍4: 烟火声
- 队伍6: wei, 刘能
- 队伍7: 河粉

## 文件结构

```
.
├── dota2_analyzer.py      # 主分析脚本（增强版）
├── dota2_player_stats.py  # 基础爬取脚本
├── player_ids.csv         # 玩家ID列表
├── README.md              # 本文档
└── output/                # 输出目录
    ├── bp_report_*.html   # BP专用报告
    ├── bp_report_*.txt    # BP报告文本版
    ├── dota2_report_*.html
    ├── dota2_summary_*.txt
    └── dota2_analysis_*.json
```

## API 文档

- OpenDota API: https://docs.opendota.com/

## License

MIT License
